<div id="user-id" data-user-id=" <%= current_user.id %> "> </div>
<div id="ticket-id" data-ticket-id=" <%= @ticket.id %> "> </div>
<div class="col-lg-12">
  <div class="card rounded-0 mt-5 mb-5">
    <div class="card-body" >
      <h2 class="text-center">Ticket Details</h2>
      <div class="row">
        <div class= "col-lg-6">
          <p class="lead">
            <strong> Subject : </strong> <%= @ticket.subject %> 
          </p>
          <p class="lead">
            <strong> Description : </strong> <%= @ticket.description %> 
          </p>
          <p class="lead">
            <strong> Due Date : </strong> <%= @ticket.due_date %> 
          </p>
          <p class="lead">
            <strong> Priority : </strong> <%= @ticket.priority %> 
          </p>
          <% if current_user.id == @ticket.creator_id %>
            <p class="lead">
              <strong> Assigend to : </strong> <%= @ticket.assigned_to.name %> 
            </p>
          <%else%>
            <p class="lead">
              <strong> Assigend By : </strong> <%= @ticket.creator.name %> 
            </p>
          <%end%>
          <%= render 'documents_attached', { model_instance: @ticket }%>
          <br>
          <%= render 'trasistions_button', { ticket: @ticket }%>   
        </div>
      </div>
    </div>
  </div>
</div>

<div class="messages_container" style=" padding:30px; background:white; ">
  <h4 class="text-center" > Messages </h4>
  <br>
  <div id="messages">
    <% @ticket.messages.each do | message |%>
      <% if  message.user_id == current_user.id %>
        <div  style="display: block; text-align-last: end; margin:2px; ">
          <p style="margin: 0px; background:skyblue;" > 
            <%= render 'documents_attached', { model_instance: message }%>
            <br>
            <%= message.content %> 
          </p>
      <% else %>
        <div  style="display: block; margin:2px ">
          <p style="margin: 0px;">
            <%= render 'documents_attached', { model_instance: message }%>
            <br>
            <%= message.content %>
          </p>
      <% end %>
      </div>
    <% end %>
  </div>

  <div>
    <%= form_with(model: [@ticket , @ticket.messages.build],url: ticket_messages_path(@ticket, user_id: current_user), method: :post) do | f |%>
      <p>
        <br>
        <%= f.label :documents,"Attach Document", class:"form-label" %>
        <%= f.file_field :documents, multiple: true, class: "form-select"%>
        <%= f.text_field :content,id: 'message_content', class: 'form-control', style:"width:84%; display: inline-block;"%> 
        <%#= f.hidden_field :user_id , required: true,  value:current_user.id %>
        <%= f.submit "Send",data: { disable_with: false }, class:"btn btn-primary" %>
      </p>
    <% end %>
  </div>
</div>






